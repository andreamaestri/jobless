{% load job_tags %}

<div class="divide-y divide-base-200">
    {% if jobs %}
        {% for job in jobs %}
        <div class="space-y-3">
            <!-- Main Content - Make entire area clickable -->
            <a href="{% url 'jobs:detail' job.id %}" 
               class="block p-4 space-y-3 active:bg-base-200/50 transition-colors">
                <!-- Company and Logo -->
                <div class="flex items-center gap-3">
                    {% if job.company_logo %}
                    <div class="avatar">
                        <div class="w-12 h-12 rounded-xl">
                            <img src="{{ job.company_logo.url }}" alt="{{ job.company_name }}" />
                        </div>
                    </div>
                    {% else %}
                    <div class="w-12 h-12 rounded-xl bg-primary/10 flex items-center justify-center">
                        <iconify-icon icon="heroicons:building-office" class="text-2xl text-primary"></iconify-icon>
                    </div>
                    {% endif %}
                    <div class="min-w-0">
                        <div class="font-semibold text-base text-base-content truncate">{{ job.company }}</div>
                        <div class="text-sm text-base-content/70 flex items-center gap-1.5">
                            <iconify-icon icon="heroicons:map-pin" class="text-base"></iconify-icon>
                            {{ job.location }}
                        </div>
                    </div>
                </div>

                <!-- Job Title and Department -->
                <div>
                    <div class="font-medium text-lg text-primary">{{ job.title }}</div>
                    {% if job.department %}
                    <div class="text-sm text-base-content/60 mt-0.5">{{ job.department }}</div>
                    {% endif %}
                </div>

                <!-- Skills -->
                {% if job.skills.all %}
                <div class="flex flex-wrap gap-1.5 items-center pt-1">
                    {% for skill in job.skills.all %}
                    <div class="tooltip tooltip-top before:z-50 before:shadow-lg" data-tip="{{ skill }}">
                        <div class="w-8 h-8 rounded-lg bg-base-200/50 flex items-center justify-center">
                            <iconify-icon icon="{{ skill|get_skill_icon }}" 
                                         class="text-xl transition-all duration-200"
                                         width="20"
                                         height="20">
                            </iconify-icon>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Status -->
                <div class="flex items-center gap-2">
                    <span class="badge {{ job.status|status_badge }} badge-md gap-1.5">
                        <iconify-icon icon="{{ job.status|status_icon }}"></iconify-icon>
                        {{ job.get_status_display }}
                    </span>
                </div>
            </a>

            <!-- Actions Bar -->
            <div class="flex items-center justify-between px-4 pb-4">
                <button class="btn btn-ghost btn-sm gap-2 px-3"
                        hx-post="{% url 'jobs:toggle_favorite' job.pk %}"
                        hx-swap="none"
                        @click="toggleFavorite({{ job.pk }})"
                        :class="{ 'text-warning': isFavorited({{ job.pk }}) }">
                    <iconify-icon :icon="isFavorited({{ job.pk }}) ? 'octicon:star-fill-16' : 'octicon:star-16'"
                                  class="text-lg"></iconify-icon>
                    <span x-text="isFavorited({{ job.pk }}) ? 'Favorited' : 'Favorite'"></span>
                </button>
                
                <div class="flex items-center gap-2">
                    <a href="{% url 'jobs:edit' job.pk %}" 
                       class="btn btn-ghost btn-sm gap-2 px-3">
                        <iconify-icon icon="octicon:pencil-16"></iconify-icon>
                        Edit
                    </a>
                    <button class="btn btn-ghost btn-sm text-error gap-2 px-3"
                            hx-delete="{% url 'jobs:delete' job.pk %}"
                            hx-confirm="Are you sure you want to delete this job?"
                            hx-target="closest div.space-y-3"
                            hx-swap="outerHTML swap:1s">
                        <iconify-icon icon="octicon:trash-16"></iconify-icon>
                        Delete
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="p-8 text-center text-base-content/60">
            <span class="icon text-3xl mb-2 block" data-icon="octicon:inbox-24"></span>
            <p>No jobs found matching your criteria</p>
        </div>
    {% endif %}
</div>
