document.addEventListener("alpine:init",()=>{Alpine.data("skillSelector",()=>({viewMode:"search",searchQuery:"",categories:[],selectedSkills:[],allSkills:[],init(){var i;const e=Alpine.store("skills");this.loadSkillsData(e.tagulousSettings||{}),(i=e.initialTags)!=null&&i.length&&this.loadInitialSkills(e.initialTags)},loadSkillsData(e){const i=e.autocomplete_choices||[],s=Alpine.store("skills");this.allSkills=i.map(l=>({id:l[0],label:l[1],icon:s.iconMapping[l[1]]||"heroicons:academic-cap",path:l[2]||""}));const t=new Map;this.allSkills.forEach(l=>{const a=l.path.split(":");if(a.length>1){const n=a.slice(0,-1).join(":"),c=a[a.length-2]||"Uncategorized";t.has(n)||t.set(n,{path:n,label:c,skills:[],expanded:!1}),t.get(n).skills.push(l)}}),this.categories=Array.from(t.values())},loadInitialSkills(e){e.forEach(i=>{const s=this.allSkills.find(t=>t.id===i[0]);s&&this.selectedSkills.push({...s,proficiency:"required"})})},get filteredSkills(){if(!this.searchQuery)return this.allSkills;const e=this.searchQuery.toLowerCase();return this.allSkills.filter(i=>i.label.toLowerCase().includes(e))},get skillsJson(){return JSON.stringify(this.selectedSkills.map(e=>({skill:e.id,proficiency:e.proficiency,name:e.label})))},toggleCategory(e){e.expanded=!e.expanded},isSelected(e){return this.selectedSkills.some(i=>i.id===e)},toggleSkill(e){this.isSelected(e.id)?this.removeSkill(e):this.addSkill(e);const i=document.querySelector('input[name="skills"]');i&&(i.value=this.skillsJson,i.dispatchEvent(new Event("change",{bubbles:!0})))},addSkill(e){this.isSelected(e.id)||this.selectedSkills.push({...e,proficiency:"required"})},removeSkill(e){this.selectedSkills=this.selectedSkills.filter(i=>i.id!==e.id)},updateSkill(e){const i=this.selectedSkills.findIndex(s=>s.id===e.id);i!==-1&&(this.selectedSkills[i]={...e})}}))});
