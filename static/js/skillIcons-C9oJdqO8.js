function p(l,e){let t=null;const i=()=>{t&&t(),t=e()},s=()=>{t&&(t(),t=null)};return l.addEventListener("mouseenter",i),l.addEventListener("mouseleave",s),l.addEventListener("touchstart",i,{passive:!0}),l.addEventListener("touchend",s),l.addEventListener("touchcancel",s),()=>{l.removeEventListener("mouseenter",i),l.removeEventListener("mouseleave",s),l.removeEventListener("touchstart",i),l.removeEventListener("touchend",s),l.removeEventListener("touchcancel",s),t&&t()}}class m{constructor(){this.darkMode=window.matchMedia("(prefers-color-scheme: dark)").matches,this.watchThemeChanges(),this.initialized=!0,this.initializationAttempts=0,this.iconMappings={}}async initialize(){try{const e=await fetch("/jobs/api/skills/");if(!e.ok)throw new Error("Failed to load skills data");(await e.json()).forEach(i=>{this.iconMappings[i.name.toLowerCase()]=i.icon}),await this.updateIcons(),console.log("Icons initialized successfully")}catch(e){console.warn("Falling back to basic functionality:",e)}}async refreshIconElement(e,t,i=null){if(!(!e||!t))try{e.style.display="inline-block",e.style.visibility="visible";const s=this.iconMappings[t.toLowerCase()]||"heroicons:academic-cap";e.setAttribute("icon",s),e.setAttribute("width","20"),e.setAttribute("height","20");const r=e.parentElement;if(r){const o=e.nextSibling;e.remove(),o?r.insertBefore(e,o):r.appendChild(e)}}catch{console.warn(`Failed to refresh icon for skill: ${t}`),e.setAttribute("icon","octicon:code-16")}}watchThemeChanges(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{this.darkMode=t.matches,this.updateIcons()})}async updateIcons(){const e=document.querySelectorAll("iconify-icon[data-icon][data-icon-dark]");for(const t of e){const i=t.getAttribute("data-icon"),s=t.getAttribute("data-icon-dark");await this.refreshIconElement(t,i,s)}}getIconForSkill(e){return this.iconMappings[e]||"octicon:code-16"}}document.addEventListener("DOMContentLoaded",async()=>{try{if(window.skillIconsHelper||(window.skillIconsHelper=new m,await window.skillIconsHelper.initialize()),window.skillSelectManager=new f,window.skillsManager=new u,document.getElementById("skills-select")){const t=window.skillSelectManager.initializeSelect("#skills-select");window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",s=>{window.skillSelectManager.handleThemeChange(t,s.matches)})}const e=()=>{document.querySelectorAll("iconify-icon").forEach(async t=>{var s;const i=(s=t.closest("[data-tip]"))==null?void 0:s.getAttribute("data-tip");i&&await window.skillIconsHelper.refreshIconElement(t,i)})};e(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{e()}),window.skillsHelper||(window.skillsHelper={updateIcons:e,_initialized:!0})}catch(l){console.warn("Skills initialization error:",l)}});class f{constructor(){this.skillGroups={frontend:{name:"Frontend Development",skills:["JavaScript","TypeScript","React","Vue","Angular","HTML","CSS"]},backend:{name:"Backend Development",skills:["Python","Java","Node.js","PHP","Ruby"]},database:{name:"Databases",skills:["PostgreSQL","MySQL","MongoDB","Redis"]},devops:{name:"DevOps & Tools",skills:["Docker","Kubernetes","AWS","Git"]}},this.skillKeywords={JavaScript:["js","javascript","es6"],TypeScript:["ts","typescript"],Python:["py","python"],React:["reactjs","react.js"]}}initializeSelect(e){const t=window.matchMedia("(prefers-color-scheme: dark)").matches,i=document.createElement("div");i.className="ts-dropdown-backdrop",document.body.appendChild(i);const s=new TomSelect(e,{plugins:{remove_button:{title:"Remove skill"},clear_button:{title:"Clear all skills"},dropdown_input:{},dropdown_header:{title:"Search or select skills"}},maxItems:null,maxOptions:null,valueField:"name",labelField:"name",searchField:["name","keywords"],create:!1,closeAfterSelect:!1,hideSelected:!0,persist:!1,openOnFocus:!0,preload:!0,dropdownParent:"body",optgroups:Object.entries(this.skillGroups).map(([o,n])=>({id:o,name:n.name})),optgroupField:"group",optgroupOrder:["frontend","backend","database","devops","other"],score:this.createScoreFunction(),render:{dropdown:()=>`
                        <div class="ts-dropdown">
                            <div class="ts-dropdown-header">
                                <input type="text" autocomplete="off" placeholder="Search skills...">
                                <button class="ts-dropdown-close">
                                    <iconify-icon icon="heroicons:x-mark-20-solid" width="20"></iconify-icon>
                                </button>
                            </div>
                            <div class="ts-dropdown-content"></div>
                        </div>
                    `,optgroup_header:(o,n)=>`<div class="optgroup-header">${n(o.name)}</div>`,option:(o,n)=>{const a=t&&o.icon_dark||o.icon;return`<div class="flex items-center gap-3 p-2">
                        <iconify-icon class="text-xl" icon="${n(a||"octicon:code-16")}"></iconify-icon>
                        <div>
                            <div class="font-medium">${n(o.name)}</div>
                            ${o.description?`<div class="text-xs text-base-content/70">${n(o.description)}</div>`:""}
                        </div>
                    </div>`},item:(o,n)=>{const a=t&&o.icon_dark||o.icon;return`<div class="flex items-center gap-2">
                        <iconify-icon class="text-lg" icon="${n(a||"octicon:code-16")}"></iconify-icon>
                        <span class="font-medium">${n(o.name)}</span>
                    </div>`},no_results:()=>'<div class="no-results">No matching skills found</div>'},onInitialize:function(){var n;this.input.style.display="none",this.control.setAttribute("data-placeholder","Click to add skills..."),i.addEventListener("click",()=>this.close()),(n=this.dropdown.querySelector(".ts-dropdown-close"))==null||n.addEventListener("click",()=>this.close());const o=this.dropdown.querySelector("input");o&&o.addEventListener("input",a=>{this.setTextboxValue(a.target.value),this.refreshOptions(!1)})},onDropdownOpen:function(){i.classList.add("active"),document.body.style.overflow="hidden",setTimeout(()=>{var o;(o=this.dropdown.querySelector("input"))==null||o.focus()},50)},onDropdownClose:function(){i.classList.remove("active"),document.body.style.overflow="";const o=this.dropdown.querySelector("input");o&&(o.value=""),this.setTextboxValue("")},onType:function(o){const n=this.dropdown.querySelector("input");n&&(n.value=o)}}),r=s.control.closest(".form-section");return r&&r.addEventListener("scroll",()=>s.close()),s}createScoreFunction(){return function(e){const t=this.getScoreFunction(e);return i=>!e||i.keywords&&i.keywords.some(s=>s.toLowerCase().startsWith(e.toLowerCase()))?1:t(i)}}getSkillOptions(){return Array.from(document.querySelectorAll("#skills-select option")).map(e=>{const t=JSON.parse(e.dataset.skill||"{}");return{name:t.name,icon:t.icon,icon_dark:t.icon_dark,keywords:this.getSkillKeywords(t.name),group:this.getSkillGroup(t.name)}})}getSkillKeywords(e){return this.skillKeywords[e]||[e.toLowerCase()]}getSkillGroup(e){for(const[t,i]of Object.entries(this.skillGroups))if(i.skills.includes(e))return t;return"other"}getSkillPriority(e){return this.skillPriorities[e]||50}handleThemeChange(e,t){const i=e.items;e.clear(),e.clearOptions(),e.options=e.options.map(s=>({...s,icon:t&&s.icon_dark||s.icon})),e.sync(),i.forEach(s=>e.addItem(s))}}class k{constructor(){this.magnifier=document.querySelector(".modal .letter-magnifier"),this.preview=document.querySelector(".modal .letter-preview")}createMagnifier(){}setupLetterPreview(){}showMagnifier(e,t){this.magnifier.textContent=e,this.magnifier.style.left=`${t.x}px`,this.magnifier.style.top=`${t.y}px`,this.magnifier.style.transform="translateX(-80px) scale(1)",this.magnifier.style.opacity="1"}hideMagnifier(){this.magnifier.style.transform="translateX(0) scale(0.8)",this.magnifier.style.opacity="0"}showPreview(e){this.preview.textContent=e,this.preview.classList.remove("hidden"),requestAnimationFrame(()=>{this.preview.classList.add("visible")})}hidePreview(){this.preview.classList.remove("visible"),setTimeout(()=>this.preview.classList.add("hidden"),150)}}class u{constructor(){this.isDarkMode=window.matchMedia("(prefers-color-scheme: dark)").matches,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.isDarkMode=e.matches,this.renderSelectedSkills()}),this.selectedSkills=new Set,this.skillsContainer=document.getElementById("selected-skills"),this.skillsInput=document.getElementById("skills-input"),this.skillSearch=document.getElementById("skill-search"),this.modal=document.getElementById("skills-modal"),this.iconHelper=window.skillIconsHelper,this.letterGroups=document.querySelectorAll(".skill-group[data-letter]"),this.quickJump=document.querySelector(".quick-jump-container"),this.magnifier=new k,this.placeholder=document.getElementById("skills-placeholder"),this.formSection=document.querySelector(".form-section"),this.handleSearch=this.handleSearch.bind(this),this.handleModalShow=this.handleModalShow.bind(this),this.updateActiveState=this.updateActiveState.bind(this),this.jumpToLetter=this.jumpToLetter.bind(this),this.magnifyLetterGroup=this.magnifyLetterGroup.bind(this),this.resetLetterGroup=this.resetLetterGroup.bind(this),this.showLetterPreview=this.showLetterPreview.bind(this),this.hidePreview=this.hidePreview.bind(this),this.handleCancel=this.handleCancel.bind(this),this.initializeModal(),this.setupLetterMagnification(),this.setupLetterNavigation(),this.setupLetterEffects()}updateActiveState(e){e&&requestAnimationFrame(()=>{for(const t of document.querySelectorAll(".quick-letter"))t.classList.toggle("active",t.dataset.letter===e);this.showLetterPreview(e)})}hidePreview(){this.magnifier&&this.magnifier.hidePreview()}initializeModal(){if(this.skillsInput=document.getElementById("skills-input"),this.skillsContainer=document.getElementById("selected-skills"),this.skillSearch=document.getElementById("skill-search"),this.modal=document.getElementById("skills-modal"),this.placeholder=document.getElementById("skills-placeholder"),this.skillsInput&&this.skillsContainer&&this.skillsInput.value)try{this.selectedSkills=new Set(JSON.parse(this.skillsInput.value)),this.renderSelectedSkills()}catch(e){console.warn("Error parsing skills input:",e),this.selectedSkills=new Set}this.skillSearch&&this.skillSearch.addEventListener("input",e=>this.handleSearch(e)),this.modal&&this.modal.addEventListener("show",async()=>this.handleModalShow()),this.setupLetterObserver(),this.setupLetterNavigation()}handleSearch(e){const t=e.target.value.toLowerCase(),i=t.length>0;this.letterGroups.forEach(s=>{const r=s.querySelector(".sticky"),o=s.querySelectorAll("label");let n=!1;o.forEach(a=>{const c=a.querySelector("span").textContent.toLowerCase().includes(t);a.style.display=c?"":"none",c&&(n=!0)}),s.style.display=n?"":"none",r&&(r.style.display=i?"none":"block")}),this.quickJump&&(this.quickJump.style.display=i?"none":"block")}resetModalState(){this.skillSearch&&(this.skillSearch.value="",this.letterGroups.forEach(e=>{e.style.display="";const t=e.querySelector(".sticky");t&&(t.style.display="block"),e.querySelectorAll("label").forEach(i=>{i.style.display=""})}),this.quickJump&&(this.quickJump.style.display="block")),document.querySelectorAll('#skills-modal input[type="checkbox"]').forEach(e=>{e.checked=this.selectedSkills.has(e.value)})}async handleModalShow(){document.querySelectorAll('#skills-modal input[type="checkbox"]').forEach(e=>{e.checked=this.selectedSkills.has(e.value)}),this.skillSearch&&(this.skillSearch.value="",this.skillSearch.dispatchEvent(new Event("input"))),await this.iconHelper.updateIcons(),this.resetModalState()}applySelectedSkills(){var t;const e=Array.from(document.querySelectorAll('#skills-modal input[type="checkbox"]:checked')).map(i=>{const s=JSON.parse(i.dataset.skill||"{}");return{name:s.name,icon:s.icon,icon_dark:s.icon_dark}});window.dispatchEvent(new CustomEvent("skills-updated",{detail:e})),(t=this.modal)==null||t.close()}removeSkill(e){this.selectedSkills.delete(e),this.renderSelectedSkills();const t=document.querySelector(`input[value="${e}"]`);t&&(t.checked=!1)}renderSelectedSkills(){if(!this.skillsContainer)return;this.skillsContainer.innerHTML="",this.skillsInput.value=JSON.stringify([...this.selectedSkills]),this.placeholder&&(this.selectedSkills.size===0?this.placeholder.style.display="flex":this.placeholder.style.display="none");const e=["badge-primary","badge-accent","badge-neutral"],t=JSON.parse(localStorage.getItem("skillBadgeTypes")||"{}");this.selectedSkills.forEach(i=>{const s=document.querySelector(`input[value="${i}"]`);if(!s)return;const r=JSON.parse(s.dataset.skill),o=this.isDarkMode&&r.icon_dark?r.icon_dark:r.icon;t[i]||(t[i]=e[Math.floor(Math.random()*e.length)],localStorage.setItem("skillBadgeTypes",JSON.stringify(t)));const n=t[i],a=document.createElement("div");a.className=`badge ${n} badge-lg gap-1 pr-0`,a.innerHTML=`
                <iconify-icon icon="${o}" 
                             data-icon="${r.icon}"
                             data-icon-dark="${r.icon_dark||r.icon}"
                             class="text-${n.split("-")[1]}-content"
                             width="16"></iconify-icon>
                <span class="font-medium text-${n.split("-")[1]}-content">${r.name}</span>
                <button type="button" 
                        class="btn btn-ghost btn-xs btn-square h-full rounded-l-none hover:bg-opacity-20">
                    <iconify-icon icon="heroicons:x-mark-20-solid" 
                                class="text-xs text-${n.split("-")[1]}-content">
                    </iconify-icon>
                </button>
            `,a.querySelector("button").addEventListener("click",()=>this.removeSkill(i)),this.skillsContainer.appendChild(a)}),this.formSection&&this.formSection.classList.toggle("has-skills",this.selectedSkills.size>0)}jumpToLetter(e,t=!0){const i=document.querySelector(`.skill-group[data-letter="${e}"]`);if(!i)return;const s=document.querySelector(".modal-box .overflow-y-auto"),r=document.querySelector(".modal-box .flex-none"),o=r?r.offsetHeight:0;s.classList.toggle("smooth-scroll",t),requestAnimationFrame(()=>{const n=i.offsetTop-o-8;s.scrollTo({top:n,behavior:t?"smooth":"instant"}),this.updateLetterStates(e)}),t&&setTimeout(()=>{s.classList.remove("smooth-scroll")},300)}updateLetterStates(e){document.querySelectorAll(".quick-letter").forEach(t=>{const i=t.dataset.letter;t.classList.remove("active","adjacent"),i===e?t.classList.add("active"):(i===String.fromCharCode(e.charCodeAt(0)-1)||i===String.fromCharCode(e.charCodeAt(0)+1))&&t.classList.add("adjacent")})}setupLetterNavigation(){document.querySelectorAll(".quick-letter").forEach(e=>{e.addEventListener("mouseenter",()=>{const t=e.dataset.letter;this.jumpToLetter(t,!1)}),e.addEventListener("touchstart",t=>{const i=e.dataset.letter;this._touchStartY=t.touches[0].clientY,this.jumpToLetter(i,!0)},{passive:!0}),e.addEventListener("click",t=>{t.preventDefault();const i=e.dataset.letter;this.jumpToLetter(i,!0)})})}setupLetterObserver(){const e=new IntersectionObserver(t=>{t.forEach(i=>{if(!i.isIntersecting)return;const s=i.target.dataset.letter;s&&requestAnimationFrame(()=>{this.updateActiveState(s)})})},{threshold:.5,rootMargin:"-80px 0px -60% 0px"});document.querySelectorAll(".skill-group").forEach(t=>{e.observe(t)})}setupLetterMagnification(){const e=document.querySelectorAll(".quick-letter"),t=document.querySelector(".quick-letters-list"),i=document.querySelector(".modal-box");e.forEach((s,r)=>{p(s,()=>{const o=s.getBoundingClientRect(),n=t.getBoundingClientRect(),a=i.getBoundingClientRect();this.updateActiveState(s.dataset.letter);const d=o.bottom>a.bottom-100,c={x:n.left-16,y:Math.min(o.top+o.height/2,a.bottom-50)};if(this.magnifier.showMagnifier(s.dataset.letter,c),this.magnifyLetterGroup(e,r),this.magnifier.showPreview(s.dataset.letter),d){const h=i.querySelector(".overflow-y-auto");h&&h.scrollTo({top:h.scrollHeight,behavior:"smooth"})}return()=>{this.resetLetterGroup(e,r),this.magnifier.hideMagnifier(),this.magnifier.hidePreview()}})})}magnifyLetterGroup(e,t){const i=e[t];i&&i.classList.add("letter-magnified","letter-primary"),[-1,1].forEach(s=>{const r=e[t+s];r&&r.classList.add("letter-neighbor")})}resetLetterGroup(e,t){[t-1,t,t+1].forEach(s=>{const r=e[s];r&&r.classList.remove("letter-magnified","letter-primary","letter-neighbor")})}setupLetterEffects(){const e=document.querySelectorAll(".quick-letter"),t=document.querySelector(".quick-letters-list");if(!t||!e.length)return;let i=null,s=0;const r=100,o=document.querySelector(".modal-box .overflow-y-auto");o&&o.addEventListener("scroll",()=>{const n=Date.now();if(n-s<r)return;s=n;const a=this.findVisibleLetterGroup();a&&a.dataset.letter!==i&&(i=a.dataset.letter,this.updateLetterStates(i))},{passive:!0}),t.addEventListener("touchstart",n=>{this._touchStartY=n.touches[0].clientY},{passive:!0}),t.addEventListener("touchmove",n=>{const a=this.findLetterAtPosition(n.touches[0].clientY);a&&this.jumpToLetter(a,!1)},{passive:!0}),t.addEventListener("touchend",()=>{this._touchStartY=null},{passive:!0})}findLetterAtPosition(e){const t=document.querySelectorAll(".quick-letter");for(const i of t){const s=i.getBoundingClientRect();if(e>=s.top&&e<=s.bottom)return i.dataset.letter}return null}handleLetterTouchStart(e){e.preventDefault();const t=this.findLetterAtPosition(e.touches[0].clientY);t&&this.jumpToLetter(t,!0)}findVisibleLetterGroup(){const e=document.querySelectorAll(".skill-group"),t=document.querySelector(".modal-box").getBoundingClientRect().top;for(const i of e){const s=i.getBoundingClientRect();if(s.top>=t&&s.bottom>t)return i}return null}updateLetterStates(e){document.querySelectorAll(".quick-letter").forEach(t=>{t.classList.toggle("active",t.dataset.letter===e)})}showLetterPreview(e){if(!this.magnifier)return;this.magnifier.showPreview(e);const t=document.querySelector(`.skill-group[data-letter="${e}"]`);if(t){let i=t.querySelector(".letter-group-highlight");i||(i=document.createElement("div"),i.className="letter-group-highlight",t.insertBefore(i,t.firstChild)),i.classList.add("visible"),setTimeout(()=>i.classList.remove("visible"),500)}}handleCancel(e){var i;e.preventDefault();const t=e.target.closest("form");return t&&(t.classList.remove("was-validated"),t.querySelectorAll(".text-error").forEach(s=>s.textContent=""),t.reset()),this.resetModalState(),(i=this.modal)!=null&&i.open&&this.modal.close(),window.location.href=e.target.href,!1}openModal(e=[]){var t;this.selectedSkills=new Set(e.map(i=>i.name)),(t=this.modal)==null||t.showModal(),this.handleModalShow()}}function y(l){const e=l.target.closest("form");e&&(e.noValidate=!0,setTimeout(()=>e.noValidate=!1,100));const t=document.querySelector("dialog[open]");return t&&t.close(),!0}window.handleCancel=y;document.addEventListener("DOMContentLoaded",async()=>{try{window.skillsHelper={_skills:[],_initialized:!1,async initialize(){if(this._initialized)return;if(window.SKILL_MAPPINGS){this._skills=Object.entries(window.SKILL_MAPPINGS.icons).map(([e,t])=>({text:e,icon:t,icon_dark:window.SKILL_MAPPINGS.darkVariants[t]})),this._initialized=!0;return}const l=await fetch("/jobs/api/skills/");if(!l.ok)throw new Error("Failed to load skills");this._skills=await l.json(),this._initialized=!0}},await window.skillsHelper.initialize(),window.skillsManager=new u}catch(l){console.warn("Skills initialization error:",l)}});
